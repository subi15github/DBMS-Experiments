USE SSE;
CREATE TABLE STUDENT_INFO
(
STUDENT_ID INT,
STUDENT_NAME VARCHAR(20),
STUDENT_ADDRESS VARCHAR(20),
STUDENT_SUBJECT VARCHAR(20)
);

INSERT INTO STUDENT_INFO VALUES(100,'AARAV','DELHI','COMPUTERS');
INSERT INTO STUDENT_INFO VALUES(101,'YASHPAL','AMRITSAR','HISTORY');
INSERT INTO STUDENT_INFO VALUES(105,'GAURAV','JAIPUR','LITERATURE');
INSERT INTO STUDENT_INFO VALUES(110,'RAHUL','CHANDIGARH','HISTORY');

DELIMITER //
CREATE PROCEDURE GET_RECORDS()
BEGIN
 SELECT * FROM STUDENT_INFO;
END; //

CALL GET_RECORDS();
DELIMITER ;

# CREATING TABLE CUSTOMER FOR DEMONSTRATION : 
CREATE TABLE CUSTOMER(
	CUST_NO INT,
    CUST_NAME VARCHAR(15),
    CREDIT_LIMIT INT
    );
    
INSERT INTO CUSTOMER VALUES(1001,'SUBI',65000);
INSERT INTO CUSTOMER VALUES(1002,'SAHIL',50000);
INSERT INTO CUSTOMER VALUES(1003,'ABHAY',12000);
INSERT INTO CUSTOMER VALUES(1004,'AJITH',1000000);

DELIMITER //
CREATE PROCEDURE GET_CUSTOMER_LEVEL2(
	IN CUSTOMER_NO INT,
	OUT CUSTOMER_LEVEL VARCHAR(14))
BEGIN
	DECLARE CREDIT_LIM INT;
    DECLARE CUST_LEVEL VARCHAR(14);
	SET CUST_LEVEL = ' '; 
    SELECT CREDIT_LIMIT INTO CREDIT_LIM
    FROM CUSTOMER
    WHERE CUSTOMER_NO = CUSTOMER.CUST_NO;
    
    IF CREDIT_LIM > 50000 THEN
		SET CUSTOMER_LEVEL = 'PLATINUM';
	ELSEIF (CREDIT_LIM <= 50000 AND CREDIT_LIM >= 10000) THEN
		SET CUSTOMER_LEVEL = 'GOLD';
	ELSEIF CREDIT_LIM < 10000 THEN
		SET CUSTOMER_LEVEL = 'SILVER';
	END IF;
    
END; //
DELIMITER ;

CALL GET_CUSTOMER_LEVEL2(1003, @CUSTOMER_LEVEL);

SELECT @CUSTOMER_LEVEL AS FINAL;



