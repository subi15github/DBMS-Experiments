USE SSE;

# CREATING TABLE EMPLOYEE_AUDIT : 
CREATE TABLE EMPLOYEE_AUDIT(
	EMPLOYEE_ID INT,
    LASTNAME VARCHAR(15),
    CHANGEDAT DATETIME,
    ACTION VARCHAR(14)
    );
DELIMITER //

# CREATING TRIGGER : 
CREATE TRIGGER BEFORE_EMPLOYEE_UPDATE
BEFORE UPDATE ON EMPLOYEES
FOR EACH ROW
BEGIN 
INSERT INTO EMPLOYEE_AUDIT
SET ACTION = 'UPDATE',
EMPLOYEE_ID = OLD.id,
LASTNAME = OLD.Name,
CHANGEDAT = NOW();
END; //
DELIMITER ;

# UPDATING EMPLOYEE
UPDATE EMPLOYEES
SET Name = 'michael' where id = 3;

#VIEWING EMPLOYEE_AUDIT AFTER EDIT
SELECT * FROM EMPLOYEE_AUDIT;